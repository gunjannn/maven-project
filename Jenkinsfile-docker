node{
stage('scm checkout')
{
git 'https://github.com/gunjannn/maven-project.git'
}
stage('mvn package'){
sh label: '', script: 'mvn clean package'
}
stage('docker image build')
{
 sh 'docker build -t pkw0301/tomcat:latest .'
}
stage('push images to dockerhub')
{
withCredentials([string(credentialsId: 'mydockerhubid', variable: 'mydockerhubid'), string(credentialsId: 'pkwDockerrepo', variable: 'pkwDockerrepo')]) { 
	     sh "docker login -u ${mydockerhubid} -p ${pkwDockerrepo}"

}
 sh 'docker push pkw0301/tomcat:latest'
}

stage('create container')
{
sh 'docker pull pkw0301/tomcat:latest'
sh 'docker run -d -p 7000:8080 --name gun-tomcat pkw0301/tomcat:latest'
}
}
